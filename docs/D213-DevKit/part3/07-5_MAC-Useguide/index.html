<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-D213-DevKit/part3/07-5_MAC-Useguide" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.1">
<title data-rh="true">MAC 使用指南 | 东山Π</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://artinchip.100ask.net/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://artinchip.100ask.net/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://artinchip.100ask.net/docs/D213-DevKit/part3/07-5_MAC-Useguide"><meta data-rh="true" property="og:locale" content="zh_Hans"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="MAC 使用指南 | 东山Π"><meta data-rh="true" name="description" content="1. 模块介绍"><meta data-rh="true" property="og:description" content="1. 模块介绍"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://artinchip.100ask.net/docs/D213-DevKit/part3/07-5_MAC-Useguide"><link data-rh="true" rel="alternate" href="https://artinchip.100ask.net/docs/D213-DevKit/part3/07-5_MAC-Useguide" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://artinchip.100ask.net/en/docs/D213-DevKit/part3/07-5_MAC-Useguide" hreflang="en"><link data-rh="true" rel="alternate" href="https://artinchip.100ask.net/docs/D213-DevKit/part3/07-5_MAC-Useguide" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d875fe7e.css">
<script src="/assets/js/runtime~main.3b2e3a9b.js" defer="defer"></script>
<script src="/assets/js/main.498bbc78.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="东山PI" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="东山PI" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">东山Π</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/D213-DevKit/BoardIntroduction">D213-DevKit</a><a class="navbar__item navbar__link" href="/docs/category/luban-sdk使用指南">Luban-SDK</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>简体中文</a><ul class="dropdown__menu"><li><a href="/docs/D213-DevKit/part3/07-5_MAC-Useguide" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-Hans">简体中文</a></li><li><a href="/en/docs/D213-DevKit/part3/07-5_MAC-Useguide" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li></ul></div><a href="https://github.com/100askTeam/ArtInChip-Docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/D213-DevKit/BoardIntroduction">匠芯创D213-DevKit开发板</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/D213-DevKit/SupportingResources">源码工具文档手册</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/快速启动">快速启动</a><button aria-label="展开侧边栏分类 &#x27;快速启动&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/D213-DevKit/ConfigHostEnv">安装并配置开发环境</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/luban-sdk开发">Luban-SDK开发</a><button aria-label="展开侧边栏分类 &#x27;Luban-SDK开发&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/luban-linux系统开发">Luban-Linux系统开发</a><button aria-label="折叠侧边栏分类 &#x27;Luban-Linux系统开发&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/04-1_BWMUserGuide">BWM 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/04-2_CMUUserGuide">CMU 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/04-3_DMABook">DMA 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/04-4_RTCUserGuide">RTC 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/04-5_TSensorUserGuide">TSensor 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/04-6_WatchdogUserGuide">Watchdog 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/04-7_WRIUserGuide">WRI 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/05-1_SDMCUserGuide">SDMC 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/05-2_SPI_NANDUserGuide">SPI NAND 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/05-3_SPI_NORUserGuide">SPI NOR 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/05-4_FileSystemUserGuide">文件系统使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/06-1_GE-Useguide">GE 开发指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/06-2_VE-Useguide">VE 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/06-3_Display-Useguide">Display 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/06-4_DVP-Useguide">DVP开发指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/06-8_I2S-Useguide">I2S 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/06-9_AudioCodec-Useguide">AudioCodec 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-1_CAN-Useguide">CAN 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-2_ CIR-Useguide">CIR 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-3_ GPAI-Useguide">GPAI 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-4_I2C-Useguide">I2C 开发指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/D213-DevKit/part3/07-5_MAC-Useguide">MAC 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-6_PBus-Useguide">PBus 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-7_PINCTRL-Useguide">PINCTRL 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-8_PWM-Useguide">PWM 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-9_RTP-Useguide">RTP 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-10_SPI-Useguide">SPI 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-11_UART-Useguide">UART 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-12_USB-Useguide">USB 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/07-13_PSADC-Useguide">PSADC 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/08-1_SPI-ENC">SPI ENC</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/08-2_CE-Useguide">CE 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/08-3_eFuse-Useguide">eFuse 使用指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/08-4_HardwareAuthorizationCertification">硬件授权认证</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/10-1_TouchscreenDebuggingGuide">触摸屏调试指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/10-2_DisplayDebuggingGuide">显示屏调试指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/10-3_WiFiDebuggingGuide">WiFi调试指南</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/D213-DevKit/part3/10-4_GuideToUsingTheKeyMatrix">按键矩阵使用指南</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/linux-bringup参考">Linux-Bringup参考</a><button aria-label="展开侧边栏分类 &#x27;Linux-Bringup参考&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/linux-uboot开发">Linux-Uboot开发</a><button aria-label="展开侧边栏分类 &#x27;Linux-Uboot开发&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/luban-linux系统开发"><span itemprop="name">Luban-Linux系统开发</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">MAC 使用指南</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>MAC 使用指南</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-模块介绍">1. 模块介绍<a href="#1-模块介绍" class="hash-link" aria-label="1. 模块介绍的直接链接" title="1. 模块介绍的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="11-术语定义">1.1. 术语定义<a href="#11-术语定义" class="hash-link" aria-label="1.1. 术语定义的直接链接" title="1.1. 术语定义的直接链接">​</a></h3>
<table><thead><tr><th>术语</th><th>定义</th><th>注释说明</th></tr></thead><tbody><tr><td>MAC</td><td>Media Access Control</td><td>媒体访问控制，Ethernet 中的一个组成模块，对应 OSI 参考模型中的数据链路层</td></tr><tr><td>PHY</td><td>Physic</td><td>物理接口收发器，物理对应 OSI 参考模型中的物理层</td></tr><tr><td>MII</td><td>Media Independent Interface</td><td>媒体独立接口，是 MAC 与 PHY 连接的标准接口，使用4根线来传输数据</td></tr><tr><td>RMII</td><td>Reduced MII</td><td>  简化的媒体独立接口，使用2根线来传输数据</td></tr><tr><td>GMII</td><td>Gigabit MII</td><td>千兆的媒体独立接口，使用8根线来传输数据</td></tr><tr><td>MDIO</td><td>Management Data Input/Output</td><td>PHY的管理接口，用来读/写PHY的寄存器，以控制PHY的行为或获取PHY的状态</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="12-以太网简介">1.2. 以太网简介<a href="#12-以太网简介" class="hash-link" aria-label="1.2. 以太网简介的直接链接" title="1.2. 以太网简介的直接链接">​</a></h3>
<p>以太网（Ethernet）是一种计算机局域网组网技术，基于 IEEE802.3 标准，它规定了包括物理层的连线（RJ45），电气信号（PHY）和媒体访问层（MAC）协议等， 以太网的特征是有线网络，网络中的各终端必须通过网线进行连接，以太网模块可以简单的理解为 MAC 通过 MII 总线控制 PHY 共同完成终端之间数据交换的一种设备。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="13-使用拓扑">1.3. 使用拓扑<a href="#13-使用拓扑" class="hash-link" aria-label="1.3. 使用拓扑的直接链接" title="1.3. 使用拓扑的直接链接">​</a></h3>
<p>一个典型的以太网电路至少需要如下器件的参与</p>
<ul>
<li>RJ45 连接器</li>
<li>网络变压器</li>
<li>晶振</li>
<li>PHY 收发器</li>
<li>MAC 控制器</li>
<li>AP 处理器</li>
</ul>
<p>D211 集成 MAC 控制器模块，AP 内部也可以提供 PHY 收发器所需的时钟，从而不使用外部晶振模块。</p>
<p>如果要提升硬件的防静电能力，外部一般会增加 ESD 保护电路。</p>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/ethernet-hw1-17067566515211.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/ethernet-hw1.jpg" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="14-组件拓扑">1.4. 组件拓扑<a href="#14-组件拓扑" class="hash-link" aria-label="1.4. 组件拓扑的直接链接" title="1.4. 组件拓扑的直接链接">​</a></h3>
<p>一个典型的以太网工作模块由如下组件组件组成</p>
<ul>
<li>AP Core</li>
<li>DMA</li>
<li>MAC</li>
<li>PHY</li>
</ul>
<p>AIC 的 SOC 根据型号不同，以太网模块有如下两种拓扑结构</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="141-全集成">1.4.1. 全集成<a href="#141-全集成" class="hash-link" aria-label="1.4.1. 全集成的直接链接" title="1.4.1. 全集成的直接链接">​</a></h4>
<p>SOC 内部集成 MAC 和 PHY</p>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/topo-all1-17067566709503.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/topo-all1.jpg" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="142-单-mac">1.4.2. 单 MAC<a href="#142-单-mac" class="hash-link" aria-label="1.4.2. 单 MAC的直接链接" title="1.4.2. 单 MAC的直接链接">​</a></h4>
<p>SOC 内部仅集成 MAC，需要外挂 PHY</p>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/topo-phy1-17067566899295.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/topo-phy1.jpg" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="15-模块架构">1.5. 模块架构<a href="#15-模块架构" class="hash-link" aria-label="1.5. 模块架构的直接链接" title="1.5. 模块架构的直接链接">​</a></h3>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/eth-arch1-17067566964207.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/eth-arch1.jpg" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="151-mac-架构">1.5.1. MAC 架构<a href="#151-mac-架构" class="hash-link" aria-label="1.5.1. MAC 架构的直接链接" title="1.5.1. MAC 架构的直接链接">​</a></h4>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/eth-mac1-17067567071359.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/eth-mac1.jpg" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="152-phy-架构">1.5.2. PHY 架构<a href="#152-phy-架构" class="hash-link" aria-label="1.5.2. PHY 架构的直接链接" title="1.5.2. PHY 架构的直接链接">​</a></h4>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/eth-phy1-170675671900211.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/eth-phy1.jpg" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="16-模块特性">1.6. 模块特性<a href="#16-模块特性" class="hash-link" aria-label="1.6. 模块特性的直接链接" title="1.6. 模块特性的直接链接">​</a></h3>
<ul>
<li>支持全双工/半双工</li>
<li>支持1000/100/10Mbps</li>
<li>支持 RGMII/RMII 接口</li>
<li>支持内部 DMA</li>
<li>TXFIFO/RXFIFO 的大小均为 2048Byte，均支持阈值模式和存储-转发模式</li>
<li>支持 VLAN 哈希过滤</li>
<li>支持 64-bit 哈希地址过滤、完美地址过滤（支持8个地址寄存器）</li>
<li>支持源地址的插入/替换，VLAN 的插入/替换/删除，CRC 的插入/替换/删除</li>
<li>支持接收校验和错误检测</li>
<li>支持发送校验和计算</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-使用指南">2. 使用指南<a href="#2-使用指南" class="hash-link" aria-label="2. 使用指南的直接链接" title="2. 使用指南的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="21-内核配置">2.1. 内核配置<a href="#21-内核配置" class="hash-link" aria-label="2.1. 内核配置的直接链接" title="2.1. 内核配置的直接链接">​</a></h3>
<p>内核配置主要是通过 make km（make kernel_menuconfig) 命令进行 kernel 的功能选择，配置完成后的项目存储在 “source/linux-5.10/arch/riscv/configs/d211_xxx_defconfig” 文件中</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="211-网络功能配置">2.1.1. 网络功能配置<a href="#211-网络功能配置" class="hash-link" aria-label="2.1.1. 网络功能配置的直接链接" title="2.1.1. 网络功能配置的直接链接">​</a></h4>
<p>内核中要使用以太网功能，需要首先打开和配置网络相关功能</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[*] Networking support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Networking options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;*&gt; Packet socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;*&gt; Unix domain sockets</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [*] TCP/IP networking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;*&gt;   INET: socket monitoring interface</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;*&gt; DNS Resolver support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &lt;*&gt; NETLINK: socket monitoring interface</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="212-模块驱动配置">2.1.2. 模块驱动配置<a href="#212-模块驱动配置" class="hash-link" aria-label="2.1.2. 模块驱动配置的直接链接" title="2.1.2. 模块驱动配置的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Device Drivers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [*] Network device support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [*] Ethernet driver support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            [*] ArtInChip Gigabit Ethernet driver</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="22-模块系统参数配置">2.2. 模块系统参数配置<a href="#22-模块系统参数配置" class="hash-link" aria-label="2.2. 模块系统参数配置的直接链接" title="2.2. 模块系统参数配置的直接链接">​</a></h3>
<p>这些参数主要在文件 target/d211/common/d211.dtsi 中，模块系统参数随 SOC 的设定而定，一般不能进行更改，除非更换了新的 SOC，则需要在专业人士的指导下进行更改。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gmac0: ethernet@10280000 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    compatible = &quot;artinchip,aic-mac-v1.0&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reg = &lt;0x10280000 0x10000&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interrupts = &lt;GIC_SPI 7 IRQ_TYPE_LEVEL_HIGH&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    interrupt-names = &quot;macirq&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clocks = &lt;&amp;ccu CLK_GMAC0&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clock-names = &quot;gmac&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    resets = &lt;&amp;rst RESET_GMAC0&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reset-names = &quot;gmac&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="23-功能参数配置">2.3. 功能参数配置<a href="#23-功能参数配置" class="hash-link" aria-label="2.3. 功能参数配置的直接链接" title="2.3. 功能参数配置的直接链接">​</a></h3>
<p>功能参数主要针对某一个使用方案而定，因此随着方案的不同，参数很可能不同，</p>
<p>这些参数主要在文件 target/d211/xxx/board.dts中，功能参数的设置必须和硬件原理图相匹配</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="231-gmac-参数">2.3.1. GMAC 参数<a href="#231-gmac-参数" class="hash-link" aria-label="2.3.1. GMAC 参数的直接链接" title="2.3.1. GMAC 参数的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&amp;gmac0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     pinctrl-names = &quot;default&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     pinctrl-0 = &lt;&amp;gmac0_1000m_pins&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     phy-handle = &lt;&amp;gmac0_phy&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     phy-reset-gpios = &lt;&amp;gpio_d 3 GPIO_ACTIVE_HIGH&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     phy-addr = &lt;1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     phy-mode = &quot;rgmii&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     max-speed = &lt;1000&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     aic,tx-delay = &lt;0xc&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     aic,rx-delay = &lt;0xc&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     status = &quot;okay&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> gmac0_1000m_pins: gmac0-0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     pins {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         pinmux = &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 0, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 1, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 2, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 3, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 4, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 5, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 6, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 7, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 8, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 9, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 10, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 11, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 12, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 13, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 14, 6)&gt;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         &lt;AIC16XX_PINMUX(&#x27;E&#x27;, 15, 6)&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         bias-disable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">         drive-strength = &lt;3&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> };</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<ul>
<li>
<p>pinctrl-names</p>
<p>SDK 一般会把要使用的某一功能的端口组预先定义，后期直接使用即可，定义一般放在 target/d211/common/d211-pinctrl.dtsi 文件中，目前 “pinctrl-names” 均设置为 “default” 即可</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>pinctrl-0</p>
<p>即指示 MAC 预先定义的端口组</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>phy-handle</p>
<p>MAC 和 PHY 通过 mdio 通信，因此要设定 phy 的寄存器读写地址，phy-handle 指示具体的 PHY 的配置引用对象，该对象一般包含在 MDIO 的配置中。</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>phy-reset-gpios</p>
<p>因为 SOC 集成了 MAC，因此 MAC 的 reset 可以通过某一个寄存器完成，但对于外挂 PHY 的 SOC，需要提供一个 gpio 做 PHY 的 reset 操作，因为 MAC 和 PHY 的 reset 操作需要尽量保持同步才能使二者的状态同步</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>phy-addr</p>
<p>PHY 在 MII 总线上的挂载地址，一般在硬件设计原理图有标注，如果没有特殊声明，则默认设置为1即可，驱动中会对该 MII 总线进行查询，来确定该地址是否有 PHY 设备</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>phy-mode</p>
<p>PHY 和 MAC 的工作模式，目前可选的配置项有：RMII，RGMII，RGMII-ID，RGMII，RGMII-RXID，RGMII-TXID，千兆网口要有延时配置，参 考 <a href="#gmii-time-delay-label">工作模式</a> 章节详细了解</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>max-speed</p>
<p>限制的端口的最大速度</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>aic,tx-delay</p>
<p>千兆 PHY 的发送时延，该参数对百兆 PHY 无效，如果 PHY 的 spec 上有特殊要求，则按要求填写，否则设置默认值为 0xC 即可，</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>aic,rx-delay</p>
<p>千兆 PHY 的接收时延，该参数对百兆 PHY 无效，如果 PHY 的 spec 上有特殊要求，则按要求填写，否则设置默认值为 0xC 即可，</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>aic,use_extclk</p>
<p>百兆 PHY 是否外部 clk，设置该项说明使用外部独立时钟，否则将使用 SOC 内部的时钟，此值需要结合硬件设计设置，参考 <a href="#gmac-clocks-label">时钟</a> 章节详细了解</p>
</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="232-mdio参数">2.3.2. MDIO参数<a href="#232-mdio参数" class="hash-link" aria-label="2.3.2. MDIO参数的直接链接" title="2.3.2. MDIO参数的直接链接">​</a></h4>
<p>MDIO 参数用于配置 MII Bus，其用于连接 MAC 和 PHY</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  gmac0_mdio: mdio {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            compatible = &quot;aicmac-mdio&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            gmac0_phy: ethernet-phy@1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    reg = &lt;1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<ul>
<li>
<p>ethernet-phy</p>
<p>PHY 的参数信息描述，被 MAC 的配置参数中的 phy-handle 引用</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>reg</p>
<p>PHY 的读写寄存器，PHY 设备的很多寄存器是标准的，在代码中直接定义了，此处一般设为1即可</p>
</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="233-工作模式">2.3.3. 工作模式<a href="#233-工作模式" class="hash-link" aria-label="2.3.3. 工作模式的直接链接" title="2.3.3. 工作模式的直接链接">​</a></h4>
<p>SOC 中自带了 MAC 模块，MAC 在和 PHY 配合工作前需要协商好二者的工作模式，因此需要配置 PHY 模块的工作模式，目前 MAC 仅支持 Reduced 接口</p>
<ul>
<li>RMII： 百兆模式</li>
<li>RGMII：千兆模式</li>
</ul>
<p>千兆网络 RGMII 采用边沿触发，上升沿发送一字节数据的低四位，下降沿发送剩余的高四位数数据。接收端时钟采用双边沿采样，但是如果不做额外处理，接收端无法稳定采样，为了解决这一问题，常见的作法是为 时钟信号添加延时，使其边沿对准数据总 线的稳定区间。</p>
<p>可以在控制器端（时钟端）或者 PHY 芯片内部添加时延，同一时间只能有一处时延，PHY 模块通过 phy-mode 设置项的参数和 MAC 端进行沟通协商</p>
<ul>
<li>
<ul>
<li>
<p>rgmii</p>
<p>MAC 端进行时延设置，则在 dts 文件中 aic,tx-delay 和 aic,rx-delay 均应被配置</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>rgmii-id</p>
<p>PHY 芯片进行时延设置，则在 dts 文件中 aic,tx-delay 和 aic,rx-delay 均不能被配置</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>rgmii-rxid</p>
<p>PHY 芯片进行 RX 时延配置，MAC 端进行 TX 时延设置，则在 dts 文件中 aic,tx-delay 应被配置</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>rgmii-txid</p>
<p>PHY 芯片进行 TX 时延配置，MAC 端进行 RX 时延设置，则在 dts 文件中 aic,rx-delay 应被配置</p>
</li>
</ul>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="234-百兆功能参数配置">2.3.4. 百兆功能参数配置<a href="#234-百兆功能参数配置" class="hash-link" aria-label="2.3.4. 百兆功能参数配置的直接链接" title="2.3.4. 百兆功能参数配置的直接链接">​</a></h4>
<p>参考方案为 per2-spinand，MAC 工作在百兆模式下</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&amp;gmac0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pinctrl-names = &quot;default&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pinctrl-0 = &lt;&amp;gmac0_pins&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phy-handle = &lt;&amp;gmac0_phy&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phy-reset-gpios = &lt;&amp;gpio_a 2 GPIO_ACTIVE_HIGH&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phy-addr = &lt;1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phy-mode = &quot;rmii&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max-speed = &lt;100&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aic,use_extclk;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    status = &quot;okay&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gmac0_mdio: mdio {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            compatible = &quot;aicmac-mdio&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            gmac0_phy: ethernet-phy@1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    reg = &lt;1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="235-千兆功能参数配置">2.3.5. 千兆功能参数配置<a href="#235-千兆功能参数配置" class="hash-link" aria-label="2.3.5. 千兆功能参数配置的直接链接" title="2.3.5. 千兆功能参数配置的直接链接">​</a></h4>
<p>参考方案为 per1，MAC 工作在千兆模式下</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&amp;gmac0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pinctrl-names = &quot;default&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pinctrl-0 = &lt;&amp;gmac0_1000m_pins&gt;, &lt;&amp;clk_out2_pins_b&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phy-handle = &lt;&amp;gmac0_phy&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phy-reset-gpios = &lt;&amp;gpio_f 10 GPIO_ACTIVE_HIGH&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phy-addr = &lt;1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    phy-mode = &quot;rgmii&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max-speed = &lt;1000&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aic,tx-delay = &lt;0xc&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    aic,rx-delay = &lt;0xc&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    status = &quot;okay&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gmac0_mdio: mdio {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            compatible = &quot;aicmac-mdio&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            gmac0_phy: ethernet-phy@1 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    reg = &lt;1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="24-时钟">2.4. 时钟<a href="#24-时钟" class="hash-link" aria-label="2.4. 时钟的直接链接" title="2.4. 时钟的直接链接">​</a></h3>
<p>MAC 和 PHY 的协同工作共牵涉到三组时钟</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="241-mac-工作时钟">2.4.1. MAC 工作时钟<a href="#241-mac-工作时钟" class="hash-link" aria-label="2.4.1. MAC 工作时钟的直接链接" title="2.4.1. MAC 工作时钟的直接链接">​</a></h4>
<p>MAC 的内部工作时钟通过 PLL_INT1 分频获得，为 50M， 工作时钟不会因为方案的不同而不同，为一固定值</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2411-配置代码">2.4.1.1. 配置代码<a href="#2411-配置代码" class="hash-link" aria-label="2.4.1.1. 配置代码的直接链接" title="2.4.1.1. 配置代码的直接链接">​</a></h5>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">plat-&gt;aicmac_clk = devm_clk_get(&amp;pdev-&gt;dev, AICMAC_RESOURCE_NAME);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clk_set_rate(plat-&gt;aicmac_clk, CSR_F_50M);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">clk_prepare_enable(plat-&gt;aicmac_clk);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2412-寄存器查验">2.4.1.2. 寄存器查验<a href="#2412-寄存器查验" class="hash-link" aria-label="2.4.1.2. 寄存器查验的直接链接" title="2.4.1.2. 寄存器查验的直接链接">​</a></h5>
<p>MAC 内部工作时钟的在 CMU 模块中统一管理，寄存器值为 0x3117 模块才能正常工作</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">reg-dump -a 0x18020440 -c 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x18020440: 00003117 00003117 00000000 00000000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="242-phy-工作时钟">2.4.2. PHY 工作时钟<a href="#242-phy-工作时钟" class="hash-link" aria-label="2.4.2. PHY 工作时钟的直接链接" title="2.4.2. PHY 工作时钟的直接链接">​</a></h4>
<p>一般 PHY  的工作时钟是 25M， 一般的设计是外挂一个晶振提供时钟给 PHY 模组，d211 对外提供几组时钟，也可以使用该时钟供给 PHY 模块工作。</p>
<p>该时钟 (clk-out) 使能在 CMU 中配置，IO 在 MAC 中配置</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&amp;cmu {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clk-out0 = &lt;25000000&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clk-out1 = &lt;25000000&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clk-out2 = &lt;25000000&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clk-out3 = &lt;25000000&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // clk-out0-enable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // clk-out1-enable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /* Enable clock out2 */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    clk-out2-enable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // clk-out3-enable;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&amp;gmac0 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pinctrl-names = &quot;default&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pinctrl-0 = &lt;&amp;gmac0_1000m_pins&gt;, &lt;&amp;clk_out2_pins_b&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="243-mdc-时钟">2.4.3. MDC 时钟<a href="#243-mdc-时钟" class="hash-link" aria-label="2.4.3. MDC 时钟的直接链接" title="2.4.3. MDC 时钟的直接链接">​</a></h4>
<p>MDC 时钟是 mdio 的工作时钟，是 MAC 和 PHY 进行配置的工作时钟，双方在使用初期会有一个协商，一般是 MAC 通知 PHY， 该时钟为 MAC 通过模块的内部工作时钟处理生成，也不会因为方案的不同而不同，为一固定值， 目前是 AHB 总线的时钟，240M</p>
<p>MDC 时钟配置错误，则 MAC 和 PHY 的通信不通，呈现的现象是 MAC 无法发现 PHY 设备</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2431-配置代码">2.4.3.1. 配置代码<a href="#2431-配置代码" class="hash-link" aria-label="2.4.3.1. 配置代码的直接链接" title="2.4.3.1. 配置代码的直接链接">​</a></h5>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">define AICMAC_CSR_DEFAULT      AICMAC_CSR_150_250M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">value |= (priv-&gt;plat-&gt;clk_csr &lt;&lt; mdio_data-&gt;mii_reg.clk_csr_shift) &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mdio_data-&gt;mii_reg.clk_csr_mask;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2432-寄存器查验">2.4.3.2. 寄存器查验<a href="#2432-寄存器查验" class="hash-link" aria-label="2.4.3.2. 寄存器查验的直接链接" title="2.4.3.2. 寄存器查验的直接链接">​</a></h5>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">BIT(2,5) 为 0100，150-250MHz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reg-dump -a 0x10280090 -c 4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280090: 00000a90 00000000 00000000 00000000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="244-mdata-时钟">2.4.4. MDATA 时钟<a href="#244-mdata-时钟" class="hash-link" aria-label="2.4.4. MDATA 时钟的直接链接" title="2.4.4. MDATA 时钟的直接链接">​</a></h4>
<p>MDATA 时钟 (TXC) 为 MAC 和 PHY 进行数据传输的时钟，对于百兆和千兆有不同的使用方式</p>
<ul>
<li>百兆网络：可以是 MAC 供给 PHY， 也可以是 PHY 供给 MAC</li>
<li>千兆网络：只能是 MAC 供给 PHY，RGMII0-TXCK 端口</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2441-phy-提供给-mac">2.4.4.1. PHY 提供给 MAC<a href="#2441-phy-提供给-mac" class="hash-link" aria-label="2.4.4.1. PHY 提供给 MAC的直接链接" title="2.4.4.1. PHY 提供给 MAC的直接链接">​</a></h5>
<ul>
<li>dts 中设置 aic,use_extclk;</li>
<li>寄存器：0x18000410 值为 00000002</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="2442-mac-提供给-phy">2.4.4.2. MAC 提供给 PHY<a href="#2442-mac-提供给-phy" class="hash-link" aria-label="2.4.4.2. MAC 提供给 PHY的直接链接" title="2.4.4.2. MAC 提供给 PHY的直接链接">​</a></h5>
<ul>
<li>dts 中  不设置 aic,use_extclk;</li>
<li>寄存器：0x18000410 值为 00000000</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="25-mac地址">2.5. MAC地址<a href="#25-mac地址" class="hash-link" aria-label="2.5. MAC地址的直接链接" title="2.5. MAC地址的直接链接">​</a></h3>
<p>MAC地址的使用优先级是</p>
<ul>
<li>
<ul>
<li>
<p>调试配置</p>
<p>在 dts 的 gmac 配置域中添加： local-mac-address = [2e f6 01 e3 76 b6];</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>用户配置</p>
<p>用户生产时配置在特殊数据分区中的 MAC 地址，</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>加密 CHIPID</p>
<p>uboot 中获取 chipID，加密成 mac 地址，并通过 dts 的 local-mac-address 配置给 kernel 使用</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>Random</p>
<p>kernel 驱动中在无法从以上获得 mac 地址的时候，会 random 一个值作为 mac 地址使用</p>
</li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-调试指南">3. 调试指南<a href="#3-调试指南" class="hash-link" aria-label="3. 调试指南的直接链接" title="3. 调试指南的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="31-调试开关">3.1. 调试开关<a href="#31-调试开关" class="hash-link" aria-label="3.1. 调试开关的直接链接" title="3.1. 调试开关的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="311-log-等级">3.1.1. Log 等级<a href="#311-log-等级" class="hash-link" aria-label="3.1.1. Log 等级的直接链接" title="3.1.1. Log 等级的直接链接">​</a></h4>
<p>调试的时候需要设置 log 等级为最高7，设置方法为通过 make km (make kernel_menuconfig) 命令打开 kernel 的 menuconfig</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Kernel hacking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    printk and dmesg options</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (8) Default console loglevel (1-15)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        (7) Default message log level (1-7)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="312-调试开关">3.1.2. 调试开关<a href="#312-调试开关" class="hash-link" aria-label="3.1.2. 调试开关的直接链接" title="3.1.2. 调试开关的直接链接">​</a></h4>
<p>通过 make km (make kernel_menuconfig) 命令打开 kernel 的 menuconfig， 如下路径选中 GMAC 的调试开关</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Kernel hacking</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [*] Kernel debuging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ArtInChip Debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        [*] GMAC Driver Debug</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="32-功能验证">3.2. 功能验证<a href="#32-功能验证" class="hash-link" aria-label="3.2. 功能验证的直接链接" title="3.2. 功能验证的直接链接">​</a></h3>
<p>网络模块是否可以正常工作可以通过如下顺序排查：</p>
<ul>
<li>驱动是否加载成功</li>
<li>本机 MAC 和 PHY 的连接是否成功</li>
<li>本机 PHY 和对端 PHY 的连接是否成功</li>
<li>本机网络和对端网络的连接是否成功</li>
<li>是否可以通信</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="321-驱动加载">3.2.1. 驱动加载<a href="#321-驱动加载" class="hash-link" aria-label="3.2.1. 驱动加载的直接链接" title="3.2.1. 驱动加载的直接链接">​</a></h4>
<p>在 log 等级为7的情况下，可以通过如下信息对模块的启动进程进行追踪</p>
<ul>
<li>
<p>有任何的 error 信息输出，模块都将不正常工作，因此任何的 error 信息都必须要解决</p>
</li>
<li>
<ul>
<li>
<p>libphy: aicgmac: probed</p>
<p>总线注册成功</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>aicmac_probe success.</p>
<p>驱动加载成功，使用 ifconfig -a 命令应该可以看到设备</p>
</li>
</ul>
</li>
<li>
<p>其他日志</p>
</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_phy_init_data phy_addr = 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_mac_init_data mac_interface:8 max_speed:1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_mdio_init_data mdio:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mac addr: 4a:2a1e:fbeb:26</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_platform_get_config bus_id:0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">libphy: aicgmac: probed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_probe success.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="322-设备可发现">3.2.2. 设备可发现<a href="#322-设备可发现" class="hash-link" aria-label="3.2.2. 设备可发现的直接链接" title="3.2.2. 设备可发现的直接链接">​</a></h4>
<p>驱动加载成功的主要标志是网络设备存在，可以通过 “ifconfig -a” 命令查看设备是否存在，如果某一个设备不存在，则要排查驱动是否编译，是否加载，设备的系统参数和功能参数配置是否正确</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[aic@] # ifconfig -a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eth0    Link encap:Ethernet  HWaddr DA:BD:4C:BA:5D:80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BROADCAST MULTICAST  MTU:1500  Metric:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX packets:0 errors:0 dropped:0 overruns:0 frame:0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TX packets:0 errors:0 dropped:0 overruns:0 carrier:0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        collisions:0 txqueuelen:1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Interrupt:25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">eth1    Link encap:Ethernet  HWaddr 6A:8D:2A:7F:EA:3E</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        BROADCAST MULTICAST  MTU:1500  Metric:1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX packets:0 errors:0 dropped:0 overruns:0 frame:0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TX packets:0 errors:0 dropped:0 overruns:0 carrier:0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        collisions:0 txqueuelen:1000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Interrupt:26</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="323-设备可启动">3.2.3. 设备可启动<a href="#323-设备可启动" class="hash-link" aria-label="3.2.3. 设备可启动的直接链接" title="3.2.3. 设备可启动的直接链接">​</a></h4>
<p>设备启动的时候 MAC 会尝试和 PHY 建立连接，可以通过 “ifconfig eth0 up” 命令来启动网络设备，如果启动不成功，则说明 MAC 和 PHY 的连接不成功， 居多 MDC 时钟不工作， 也可能是 phy-addr 设置错误</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[aic@] # ifconfig eth0 up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gmac 10280000.ethernet eth0: PHY [aicgmac-0:01] driver [RTL8211F Gigabit Ethernet] (irq=POLL)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gmac 10280000.ethernet eth0: RX IPC Checksum Offload disabled</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gmac 10280000.ethernet eth0: configuring for phy/rgmii link mode</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="324-网络可联通">3.2.4. 网络可联通<a href="#324-网络可联通" class="hash-link" aria-label="3.2.4. 网络可联通的直接链接" title="3.2.4. 网络可联通的直接链接">​</a></h4>
<p>网络的联通是本机 PHY 和远端 PHY 通过网线建立的，同时要牵涉到 MAC 到 PHY,PHY 到 PHY，PHY 到 MAC 的一个循环</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3241-物理连接信息">3.2.4.1. 物理连接信息<a href="#3241-物理连接信息" class="hash-link" aria-label="3.2.4.1. 物理连接信息的直接链接" title="3.2.4.1. 物理连接信息的直接链接">​</a></h5>
<p>PHY 和 PHY 的协商是自动的，不需要 MAC,AP 的参与，因此两个 PHY 通过网线连接时，二者应该是自协商成功的，对于有指示灯的系统，PHY 物理连接成功后指示灯会呼吸</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3242-模块状态信息">3.2.4.2. 模块状态信息<a href="#3242-模块状态信息" class="hash-link" aria-label="3.2.4.2. 模块状态信息的直接链接" title="3.2.4.2. 模块状态信息的直接链接">​</a></h5>
<p>通过命令 “ifconfig eth0 up” 打开设备，如果连接成功，则会报告 Link is Up 的信息，如下所示</p>
<p>如果没有连接成功，并且 MAC 和 PHY 的连接是成功的，则说明两个 PHY 的连接或者协商不成功，有两个可能</p>
<ul>
<li>二者的工作模块无法协商成功，如某一方只支持百兆，而另一方只支持千兆，或者是两个标准的 PHY 模块等，可以更换对端的网络设备，如换为路由器，PC 等</li>
<li>物理网络不通，更换网线</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[aic@] # ifconfig eth0 up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gmac 10280000.ethernet eth0: Link is Up - 1Gbps/Full - flow control rx/tx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IPv6: ADDRCONF(NETDEV_CHANGE): eth0: link becomes ready</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[aic@] # ethtool  eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Speed: 1000Mb/s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Duplex: Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Auto-negotiation: on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    master-slave cfg: preferred slave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    master-slave status: master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Port: Twisted Pair</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PHYAD: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Transceiver: external</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MDI-X: Unknown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supports Wake-on: d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wake-on: d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Current message level: 0x0000003f (63)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                           drv probe link timer ifdown ifup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Link detected: yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="325-网络可通信">3.2.5. 网络可通信<a href="#325-网络可通信" class="hash-link" aria-label="3.2.5. 网络可通信的直接链接" title="3.2.5. 网络可通信的直接链接">​</a></h4>
<p>经过上述的排查，MAC 和 PHY，PHY 和远端 PHY 的通路均正常，则可以进行网络通信验证</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3251-验证方法">3.2.5.1. 验证方法<a href="#3251-验证方法" class="hash-link" aria-label="3.2.5.1. 验证方法的直接链接" title="3.2.5.1. 验证方法的直接链接">​</a></h5>
<ul>
<li>通过 ifconfig eth0 ipaddr 设置一IP地址</li>
<li>通过 ping 对端 ipaddr 来验证是否可以通信</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[aic@] # ifconfig eth0 192.168.168.100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[aic@] # ping 192.168.168.101</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">PING 192.168.168.101 (192.168.168.101): 56 data bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.168.101: seq=0 ttl=64 time=4.004 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.168.101: seq=1 ttl=64 time=0.943 ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">64 bytes from 192.168.168.101: seq=2 ttl=64 time=0.818 ms</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3252-问题分析">3.2.5.2. 问题分析<a href="#3252-问题分析" class="hash-link" aria-label="3.2.5.2. 问题分析的直接链接" title="3.2.5.2. 问题分析的直接链接">​</a></h5>
<p>如果通信不正常，在没有对驱动进行修改的情况下，一般不会是寄存器配置的问题，可能的原因有</p>
<ul>
<li>cl k配置，如果使用外部 clk，则要设置 aic,use_extclk</li>
<li>clk 频率，测量 MII Data的TX/RX Clk 的频率，满足当前标准</li>
<li>时延，如果使用的是千兆网络，确定时延的配置和硬件匹配</li>
<li>防火墙，确认路由器，对端设备不受防火墙的隔离保护</li>
</ul>
<p>如果以上问题均排除，则请获取日志提交原厂分析</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="33-寄存器信息">3.3. 寄存器信息<a href="#33-寄存器信息" class="hash-link" aria-label="3.3. 寄存器信息的直接链接" title="3.3. 寄存器信息的直接链接">​</a></h3>
<p>一个可以正常工作的 MAC 模块的寄存器样板</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="331-千兆">3.3.1. 千兆<a href="#331-千兆" class="hash-link" aria-label="3.3.1. 千兆的直接链接" title="3.3.1. 千兆的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">reg-dump -a 0x10280000 -c 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280000: 00000012 06432208 00080400 04660000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280010: 0001a061 00000000 00000000 00000311</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280020: 00000003 00000061 00000009 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280030: 00000000 ffff000e 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280040: 00000404 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280050: 80009d32 195ef056 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280060: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280070: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280080: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280090: 00000850 000079ad 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800a0: 00000000 0000000d 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800b0: 4341c000 43418000 4341c000 434182e0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800c0: 00000000 40d25000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800d0: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800e0: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800f0: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280100: 00002000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280110: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280120: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280130: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280140: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280150: 00000000 00000000 00000000 ffffffff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280160: 00000000 00000000 00000000 00000000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="332-百兆">3.3.2. 百兆<a href="#332-百兆" class="hash-link" aria-label="3.3.2. 百兆的直接链接" title="3.3.2. 百兆的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">reg-dump -a 0x10280000 -c 128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280000: 00000016 06432208 00080400 00660000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280010: 0001a061 00000000 00000000 00000311</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280020: 00000003 00000061 00000009 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280030: 00000000 ffff000e 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280040: 00000404 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280050: 8000c416 44da1a5a 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280060: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280070: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280080: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280090: 00000850 0000786d 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800a0: 00000000 00000008 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800b0: 4383c000 43838000 4383c000 43838440</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800c0: 00000000 41f9c000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800d0: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800e0: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x102800f0: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280100: 00002000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280110: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280120: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280130: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280140: 00000000 00000000 00000000 00000000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280150: 00000000 00000000 00000000 ffffffff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0x10280160: 00000000 00000000 00000000 00000000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="34-驱动信息">3.4. 驱动信息<a href="#34-驱动信息" class="hash-link" aria-label="3.4. 驱动信息的直接链接" title="3.4. 驱动信息的直接链接">​</a></h3>
<p>通过 “ethtool -i eth0” 命令可以查看设备驱动信息，用以确认驱动版本，mii 总线挂载信息</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[aic@] # ethtool -i eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">driver: aicgmac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">version: 20211010</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">firmware-version:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">expansion-rom-version:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bus-info: aicgmac-0:01 : 设备id：phy addr id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">supports-statistics: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">supports-test: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">supports-eeprom-access: no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">supports-register-dump: yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">supports-priv-flags: no</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="35-设备信息">3.5. 设备信息<a href="#35-设备信息" class="hash-link" aria-label="3.5. 设备信息的直接链接" title="3.5. 设备信息的直接链接">​</a></h3>
<p>设备的信息固化在 MAC 模块硬件寄存器和设备驱动中，通过 “ethtool eth0” 命令可以确认设备的配置信息是否正确</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="351-连接成功前">3.5.1. 连接成功前<a href="#351-连接成功前" class="hash-link" aria-label="3.5.1. 连接成功前的直接链接" title="3.5.1. 连接成功前的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[aic@] # ethtool eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Settings for eth0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supported ports: [ TP    MII ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supported link modes:   10baseT/Half 10baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            100baseT/Half 100baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            1000baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supported pause frame use: Symmetric Receive-only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supports auto-negotiation: Yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supported FEC modes: Not reported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Advertised link modes:  10baseT/Half 10baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            100baseT/Half 100baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            1000baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Advertised pause frame use: Symmetric Receive-only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Advertised auto-negotiation: Yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Advertised FEC modes: Not reported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Speed: Unknown!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Duplex: Unknown! (255)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Auto-negotiation: on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    master-slave cfg: preferred slave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    master-slave status: unknown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Port: Twisted Pair</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PHYAD: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Transceiver: external</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MDI-X: Unknown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supports Wake-on: d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wake-on: d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Current message level: 0x0000003f (63)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                           drv probe link timer ifdown ifup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Link detected: no</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="352-连 接成功后">3.5.2. 连接成功后<a href="#352-连接成功后" class="hash-link" aria-label="3.5.2. 连接成功后的直接链接" title="3.5.2. 连接成功后的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[aic@] # ethtool eth0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Settings for eth0:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supported ports: [ TP    MII ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supported link modes:   10baseT/Half 10baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            100baseT/Half 100baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            1000baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supported pause frame use: Symmetric Receive-only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supports auto-negotiation: Yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supported FEC modes: Not reported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Advertised link modes:  10baseT/Half 10baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            100baseT/Half 100baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                            1000baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Advertised pause frame use: Symmetric Receive-only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Advertised auto-negotiation: Yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Advertised FEC modes: Not reported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Link partner advertised link modes:  10baseT/Half 10baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        100baseT/Half 100baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                        1000baseT/Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Link partner advertised pause frame use: Symmetric Receive-only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Link partner advertised auto-negotiation: Yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Link partner advertised FEC modes: Not reported</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Speed: 1000Mb/s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Duplex: Full</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Auto-negotiation: on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    master-slave cfg: preferred slave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    master-slave status: slave</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Port: Twisted Pair</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PHYAD: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Transceiver: external</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MDI-X: Unknown</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Supports Wake-on: d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Wake-on: d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Current message level: 0x0000003f (63)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    drv probe link timer ifdown ifup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Link detected: yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="36-辅助工具">3.6. 辅助工具<a href="#36-辅助工具" class="hash-link" aria-label="3.6. 辅助工具的直接链接" title="3.6. 辅助工具的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="361-数据包分析">3.6.1. 数据包分析<a href="#361-数据包分析" class="hash-link" aria-label="3.6.1. 数据包分析的直接链接" title="3.6.1. 数据包分析的直接链接">​</a></h4>
<p>一般使用 WiredShark 抓包工具进行数据包的分析，可以借助其分析发送和接收的数据内容，从而分析通信双方的行为</p>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/wireshark1-170675694766213.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/wireshark1.jpg" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="362-网速测试">3.6.2. 网速测试<a href="#362-网速测试" class="hash-link" aria-label="3.6.2. 网速测试的直接链接" title="3.6.2. 网速测试的直接链接">​</a></h4>
<p>压力测试的模型是搭建一个简单的 C/S 模型，Client 以最大资源利用发送数据，Server 端接收数据并进行相应计算</p>
<p>SDK 自带两种可用于进行压力测试的工具，iperf3 和 netperf，二者会以全速进行数据的收发，并进行丢包，错包，发送速率计算等辅助工作</p>
<p>网速测试因为需要验证收到的信息的准确性，因此有比较大的计算任务，所以也受 CPU 和 DDR 频率的影响</p>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3621-iperf3">3.6.2.1. iperf3<a href="#3621-iperf3" class="hash-link" aria-label="3.6.2.1. iperf3的直接链接" title="3.6.2.1. iperf3的直接链接">​</a></h5>
<ul>
<li>
<ul>
<li>
<p>server 命令</p>
<p>iperf3 -s</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>client 命令</p>
<p>iperf3 -c 192.168.168.100 -u -b 50M ， 以 50M UDP 的方式和 server 192.168.168.100 进行测试</p>
</li>
</ul>
</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3622-netperf">3.6.2.2. netperf<a href="#3622-netperf" class="hash-link" aria-label="3.6.2.2. netperf的直接链接" title="3.6.2.2. netperf的直接链接">​</a></h5>
<ul>
<li>
<ul>
<li>
<p>server 命令</p>
<p>netserver</p>
</li>
</ul>
</li>
<li>
<ul>
<li>
<p>client 命令</p>
<p>netperf -H 192.168.168.100 ， 不限速和 server 192.168.168.100 进行测试</p>
</li>
</ul>
</li>
</ul>
<h5 class="anchor anchorWithStickyNavbar_LWe7" id="3623-持久测试">3.6.2.3. 持久测试<a href="#3623-持久测试" class="hash-link" aria-label="3.6.2.3. 持久测试的直接链接" title="3.6.2.3. 持久测试的直接链接">​</a></h5>
<p>不管是 iperf3 还是 netperf 都是进行有限次的数据交互后即停止工作，如果进行长时间的压力测试，则需要脚本配合</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Run as Server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ifconfig eth0 up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ifconfig eth0 192.168.168.100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#netserver &gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">iperf3 -s &gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#!/bin/bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#Run as Client</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ifconfig eth0 up</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ifconfig eth0 192.168.168.105</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for i in $(seq 1 10000)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo &quot;Start to test at $i times&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    #netperf -H 192.168.168.100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    iperf3 -c 192.168.168.100 -u -b 50M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sleep 5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">done</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-测试指南">4. 测试指南<a href="#4-测试指南" class="hash-link" aria-label="4. 测试指南的直接链接" title="4. 测试指南的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="41-准备工作">4.1. 准备  工作<a href="#41-准备工作" class="hash-link" aria-label="4.1. 准备工作的直接链接" title="4.1. 准备工作的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="411-物料">4.1.1. 物料<a href="#411-物料" class="hash-link" aria-label="4.1.1. 物料的直接链接" title="4.1.1. 物料的直接链接">​</a></h4>
<ul>
<li>交换机 最好是千兆交换机，因为千兆交换机兼容百兆，但百兆不兼容千兆</li>
<li>测试板 需要确定测试板的Phy端口的速度，千兆还是百兆</li>
<li>网线 可以进行路由器连接的网线</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="412-软件">4.1.2. 软件<a href="#412-软件" class="hash-link" aria-label="4.1.2. 软件的直接链接" title="4.1.2. 软件的直接链接">​</a></h4>
<p>确保 SDK 包含如下测试需要的网络软件</p>
<ul>
<li>网络设备相关软件 主要在 bosybox 中，如 ifconfig 等</li>
<li>网速测试软件 主要是 iperf3 或者 netperf，推荐 iperf3，可设置参数更多</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="42-组网拓扑">4.2. 组网拓扑<a href="#42-组网拓扑" class="hash-link" aria-label="4.2. 组网拓扑的直接链接" title="4.2. 组网拓扑的直接链接">​</a></h3>
<p>推荐两种组网拓扑，可依现实条件选择使用</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="421-直连">4.2.1. 直连<a href="#421-直连" class="hash-link" aria-label="4.2.1. 直连的直接链接" title="4.2.1. 直连的直接链接">​</a></h4>
<p>组网简单，但单机千兆 PHY 的兼容性不如交换机千兆 PHY，可能会出现 PHY 协商出错的问题</p>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/test-top11-170675700704615.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/test-top11.jpg" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="422-交换机中转">4.2.2. 交换机中转<a href="#422-交换机中转" class="hash-link" aria-label="4.2.2. 交换机中转的直接链接" title="4.2.2. 交换机中转的直接链接">​</a></h4>
<p>多一层网络设备，但对千兆网络的兼容性更好</p>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/test-top21-170675701660917.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/test-top21.jpg" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="43-功能测试">4.3. 功能测试<a href="#43-功能测试" class="hash-link" aria-label="4.3. 功能测试的直接链接" title="4.3. 功能测试的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="431-测试步骤">4.3.1. 测试步骤<a href="#431-测试步骤" class="hash-link" aria-label="4.3.1. 测试步骤的直接链接" title="4.3.1. 测试步骤的直接链接">​</a></h4>
<ul>
<li>配置好目标板的相关参数</li>
<li>按相应组网拓扑搭建好测试网络</li>
<li>开机后使能网络，并配置 IP 地址</li>
<li>通过 ping 对端的方式测试网络可以 ping 通</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="432-注意事项">4.3.2. 注意事项<a href="#432-注意事项" class="hash-link" aria-label="4.3.2. 注意事项的直接链接" title="4.3.2. 注意事项的直接链接">​</a></h4>
<ul>
<li>注意检查系统启动时 MAC 模块的打印信息，确保无错误信息和错误参数</li>
<li>注意检查相应操作的驱动信息输出，确保双方的协商参数，协商步骤一致</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="44-速度测试">4.4. 速度测试<a href="#44-速度测试" class="hash-link" aria-label="4.4. 速度测试的直接链接" title="4.4. 速度测试的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="441-测试步骤">4.4.1. 测试步骤<a href="#441-测试步骤" class="hash-link" aria-label="4.4.1. 测试步骤的直接链接" title="4.4.1. 测试步骤的直接链接">​</a></h4>
<ul>
<li>配置好目标板的相关参数</li>
<li>按相应组网拓扑搭建好测试网络</li>
<li>开机后使能网络，并配置 IP 地址</li>
<li>使用 iperf3 udp 模式测试，测试命令：iperf3 -c -u 192.168.168.100</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="442-注意事项">4.4.2. 注意事项<a href="#442-注意事项" class="hash-link" aria-label="4.4.2. 注意事项的直接链接" title="4.4.2. 注意事项的直接链接">​</a></h4>
<ul>
<li>速度测试对系统资源使用非常高，注意检查测试时系统资源的瓶颈，以此作为出错信息的判断参考</li>
<li>如果 CPU，DDR 资源是瓶颈，则可以手工降低资源的使用，iperf3 -c 192.168.168.100 -u -b 90m</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="45-兼容性测试">4.5. 兼容性测试<a href="#45-兼容性测试" class="hash-link" aria-label="4.5. 兼容性测试的直接链接" title="4.5. 兼容性测试的直接链接">​</a></h3>
<p>兼容性主要是两个模块的配合工作能力，系统有两个具有兼容性的实体（MAC 和 PHY），有一组对兼容性有大影响的参数（百兆和千兆）</p>
<p>PHY 和 PHY 之间的协商由 PHY 的电气参数完成，无软件参与，因此如果有两个设备的 PHY 无法按设计协商一致，一般归为 PHY 的问题</p>
<p>MAC 和 PHY 之间的协商一般由驱动完成，借助途径是 PHY 的读写寄存器，如果二者协商不成功，一般需要调整 PHY 的配置参数</p>
<p>因此兼容性测试可以进行如下项目的测试：</p>
<ul>
<li>百兆设备 和 百兆设备的兼容性测试</li>
<li>百兆设备 和 千兆设备的兼容性测试</li>
<li>千兆设备 和 千兆设备的兼容性测试</li>
</ul>
<p>测试方法为：</p>
<ul>
<li>拔插网线多次，均能正常识别拔插动作</li>
<li>拔插网线多次，均能正常协商为预定工作模式和速录</li>
<li>拔插网线多次，均能正常进行网络通信，ping 通</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="46-性能测试">4.6. 性能测试<a href="#46-性能测试" class="hash-link" aria-label="4.6. 性能测试的直接链接" title="4.6. 性能测试的直接链接">​</a></h3>
<ul>
<li>性能测试主要专注于时间和速度的跟踪，如果建立连接的时间，通信速度</li>
<li>性能测试可以使用 iperf3 和 netperf 完成</li>
<li>性能也会被系统资源影响，如 CPU 和 DDR 资源</li>
<li>使用 iperf3 和 netperf 进行网速测试时，client 端的 CPU 资源使用更多，因此如果 client 运行在 PC 等其他系统上，则性能值会增加</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="47-稳定性测试">4.7. 稳定性测试<a href="#47-稳定性测试" class="hash-link" aria-label="4.7. 稳定性测试的直接链接" title="4.7. 稳定性测试的直接链接">​</a></h3>
<p>性能测试需要进行多次触发性动作测试</p>
<ul>
<li>100次拔插操作，均能正常识别，正常建立连接正常通信</li>
<li>100次拔插操作后，能正常进行通信</li>
<li>1000次 enable/disable 操作后能正常通信</li>
<li>少量长时间数据通信，ping 48小时不丢包</li>
<li>长时间压力，模块不进行自动重启，测试完成后，模块功能正常</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="48-高低温测试">4.8. 高低温测试<a href="#48-高低温测试" class="hash-link" aria-label="4.8. 高低温测试的直接链接" title="4.8. 高低温测试的直接链接">​</a></h3>
<p>测试在工控标准的高温和低温环境下： - 功能正常 - 长时间通信正常 - 压力测试不导致模块自动重启</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-源码说明">5. 源码说明<a href="#5-源码说明" class="hash-link" aria-label="5. 源码说明的直接链接" title="5. 源码说明的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="51-代码结构">5.1. 代码结构<a href="#51-代码结构" class="hash-link" aria-label="5.1. 代码结构的直接链接" title="5.1. 代码结构的直接链接">​</a></h3>
<p>Ethernet 的源码牵涉三个目录</p>
<ul>
<li>MAC 驱动</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MAC的主驱动代码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drivers/net/ethernet/artinchip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>PHY 驱动</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">使用到的 mdio，phy 等模块的驱动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drivers/net/phy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>SysConfig</li>
</ul>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">系统时钟选择，delay 设置等</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">drivers/misc/artinchip-syscfg.c</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="511-文件命名说明">5.1.1. 文件命名说明<a href="#511-文件命名说明" class="hash-link" aria-label="5.1.1. 文件命名说明的直接链接" title="5.1.1. 文件命名说明的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_module_submodule.c</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_module_submodule.h</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="512-文件说明">5.1.2. 文件说明<a href="#512-文件说明" class="hash-link" aria-label="5.1.2. 文件说明的直接链接" title="5.1.2. 文件说明的直接链接">​</a></h4>
<table><thead><tr><th>文件名称</th><th>用途</th><th>备注</th></tr></thead><tbody><tr><td>aicmac.h</td><td>priv 数据结构，宏入口</td><td></td></tr><tr><td>aicmac_core.c</td><td>驱动核心逻辑</td><td></td></tr><tr><td>aicmac_platform.c</td><td>平台相关，驱动注册，dts 配置处理</td><td></td></tr><tr><td>aicmac_platform.h</td><td>platform 数据结构，包含其他模块</td><td></td></tr><tr><td>aicmac_napi.c</td><td>napi 接口及相关逻辑</td><td></td></tr><tr><td>aicmac_mac.c</td><td>mac相关逻辑代码</td><td></td></tr><tr><td>aicmac_gmac_reg.c</td><td>gmac registers</td><td></td></tr><tr><td>aicmac_dma.c</td><td>dma相关逻辑代码</td><td></td></tr><tr><td>aicmac_dma_reg.c</td><td>dma registers</td><td></td></tr><tr><td>aicmac_dma_desc.c</td><td>dma descriptor</td><td>entended descriptor</td></tr><tr><td>aicmac_dma_ring.c</td><td>dma ring mode</td><td>推荐使用 ringmode</td></tr><tr><td>aicmac_dma_chain.c</td><td>dma chain mode</td><td></td></tr><tr><td>aicmac_mdio.c</td><td>mdio 相关逻辑代码</td><td></td></tr><tr><td>aicmac_phy.c</td><td>physic 相关逻辑代码</td><td></td></tr><tr><td>aicmac_ethtool.c</td><td>ethtool 相关逻辑代码</td><td></td></tr><tr><td>aicmac_macaddr.c</td><td>mac地址各种生成逻辑</td><td></td></tr><tr><td>aicmac_util.c</td><td>公共函数</td><td>主要为信息格式化输出</td></tr><tr><td>aicmac_1588.c</td><td>IEEE1588/PTP 相关逻辑</td><td></td></tr><tr><td>aicmac_hwstamp.c</td><td>hardware stamp, 为 IEEE1588 服务</td><td></td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="513-函数命名说明">5.1.3. 函数命名说明<a href="#513-函数命名说明" class="hash-link" aria-label="5.1.3. 函数命名说明的直接链接" title="5.1.3. 函数命名说明的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_module_method</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="514-c-文件格式">5.1.4. C 文件格式<a href="#514-c-文件格式" class="hash-link" aria-label="5.1.4. C 文件格式的直接链接" title="5.1.4. C 文件格式的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// SPDX-License-Identifier: GPL-2.0-only</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Copyright (C) 2021 ArtInChip Technology Co., Ltd.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Author: Keliang Liu &lt;keliang.liu@artinchip.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include &lt;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#include “”</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="515-h-文件格式">5.1.5. H 文件格式<a href="#515-h-文件格式" class="hash-link" aria-label="5.1.5. H 文件格式的直接链接" title="5.1.5. H 文件格式的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">/* SPDX-License-Identifier: GPL-2.0-only */</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Copyright (C) 2021 ArtInChip Technology Co., Ltd.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">* Author: Keliang Liu &lt;keliang.liu@artinchip.com&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#ifndef _XXX_XXX_H_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#define _XXX_XXX_H_</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#endif</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="516-module-description">5.1.6. Module Description<a href="#516-module-description" class="hash-link" aria-label="5.1.6. Module Description的直接链接" title="5.1.6. Module Description的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">MODULE_AUTHOR(&quot;Keliang Liu&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MODULE_DESCRIPTION(&quot;ArtInChip GMAC Driver&quot;);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MODULE_ALIAS(&quot;platform:&quot; AICMAC_RESOURCE_NAME);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">MODULE_LICENSE(&quot;GPL&quot;);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="52-驱动架构">5.2. 驱动架构<a href="#52-驱动架构" class="hash-link" aria-label="5.2. 驱动架构的直接链接" title="5.2. 驱动架构的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="521-驱动架构图">5.2.1. 驱动架构图<a href="#521-驱动架构图" class="hash-link" aria-label="5.2.1. 驱动架构图的直接链接" title="5.2.1. 驱动架构图的直接链接">​</a></h4>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/mac-arch-170675729041819.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/mac-arch.jpg" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="522-驱动模块描述">5.2.2. 驱动模块描述<a href="#522-驱动模块描述" class="hash-link" aria-label="5.2.2. 驱动模块描述的直接链接" title="5.2.2. 驱动模块描述的直接链接">​</a></h4>
<ul>
<li>Platform：驱动入口，进行驱动声明和注册，dts 解析</li>
<li>Core：驱动核心逻辑，调度其他模块</li>
<li>MAC：MAC 子模块处理，其中寄存器操作接口单独封装</li>
<li>DMA：DMA 相关逻辑处理，寄存器，Ring，Chain，Descriptor 单独封装</li>
<li>MDIO：MDIO 总线相关逻辑处理</li>
<li>PHY：PHY 模块相关逻辑处理</li>
<li>NAPI：NAPI 接口逻辑处理</li>
<li>ethtool：提供 ethtool 接口的逻辑</li>
<li>mac addr：和各种外设资源配合完成 mac 地址的逻辑</li>
<li>1588：对 IEEE1588（PTP）的逻辑封装</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="523-数据结构">5.2.3. 数据结构<a href="#523-数据结构" class="hash-link" aria-label="5.2.3. 数据结构的直  接链接" title="5.2.3. 数据结构的直接链接">​</a></h4>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/mac-para-170675730037421.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/mac-para.jpg" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="524-数据流程">5.2.4. 数据流程<a href="#524-数据流程" class="hash-link" aria-label="5.2.4. 数据流程的直接链接" title="5.2.4. 数据流程的直接链接">​</a></h4>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/mac-data-170675730993123.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/mac-data.jpg" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="53-关键流程设计">5.3. 关键流程设计<a href="#53-关键流程设计" class="hash-link" aria-label="5.3. 关键流程设计的直接链接" title="5.3. 关键流程设计的直接链接">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="531-初始化流程">5.3.1. 初始化流程<a href="#531-初始化流程" class="hash-link" aria-label="5.3.1. 初始化流程的直接链接" title="5.3.1. 初始化流程的直接链接">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_platform_get_resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;kzalloc aicma_resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;platform_get_irq_byname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;devm_platform_ioremap_resource</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_platform_get_config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_platform_init_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_phy_init_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_mac_init_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_mdio_init_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_mda_init_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_napi_init_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_1588_init_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_platform_get_mac_addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_platform_init_ioirq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;handle clk: mac clk, pclk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_1588_init_clk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;devm_reset_control_get</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_core_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;devm_alloc_etherdev_mqs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;netdev_priv(ndev)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;create_singlethread_workqueue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_service_task</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;reset_control_assert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_mac_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_mac_ip_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_mac_reg_core_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;dma_set_mask_and_coherent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_napi_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;netif_set_real_num_rx_queues</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;netif_set_real_num_tx_queues</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_core_setup_napiop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;netif_napi_add(rx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;netif_napi_add(tx)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;mutex_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_mdio_register</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;mdiobus_alloc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;of_mdiobus_register</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;mdiobus_get_phy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_phy_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;phylink_create</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_1588_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;ptp_clock_register</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;register_netdev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="532-设备打开流程">5.3.2. 设备打开流程<a href="#532-设备打开流程" class="hash-link" aria-label="5.3.2. 设备打开流程的直接链接" title="5.3.2. 设备打开流程的直接链接">​</a></h4>
<p>如果在终端执行 “ifconfig eth0 up”，则进行设备打开流程，函数 aicmac_open 被调用 .. code-block:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_open</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_mac_reg_core_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_mac_reg_init_basic_config(mac, dev);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_mac_reg_init_tx_func(mac, dev);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_mac_reg_init_rx_func(mac, dev);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_phy_connect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;phylink_of_phy_connect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;mdiobus_get_phy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;phylink_connect_phy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_ring_set_16kib_bfsize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_ring_set_bfsize</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_alloc_dma_desc_resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_alloc_dma_rx_desc_resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_alloc_dma_rx_desc_resources</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_init_desc_rings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_init_rx_desc_rings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_init_tx_desc_rings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_clear_rx_descriptors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_clear_tx_descriptors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_hw_setup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_init_engine</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_mac_reg_reset</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_mac_reg_set_umac_addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_mac_reg_core_init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_mac_reg_rx_ipc_enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_mac_reg_enable_mac</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_operation_mode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_dma_reg_operation_mode_rx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_dma_reg_operation_mode_tx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_start_all_dma</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_dma_reg_start_rx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_dma_reg_start_tx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_init_coalesce</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_tx_timer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;phylink_start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;request_irq-&gt;aicmac_interrupt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_enable_all_queues</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;netif_tx_start_all_queues</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/mac-open-170675733618325.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/mac-open.jpg" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="533-数据发送流程">5.3.3. 数据发送流程<a href="#533-数据发送流程" class="hash-link" aria-label="5.3.3. 数据发送流程的直接链接" title="5.3.3. 数据发送流程的直接链接">​</a></h4>
<p>执  行任何的发送操作(如 ping 命令)，aicmac_xmit 将被调用 .. code-block:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_xmit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_tx_avail</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_vlan_insert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_ring_is_jumbo_frm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_ring_jumbo_frm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_desc_set_addr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_desc_prepare_tx_desc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;skb_tx_timestamp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;netdev_tx_sent_queue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_reg_enable_transmission</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_tx_timer_arm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/mac-xmit-170675735098827.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/mac-xmit.jpg" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="534-数据接收流程">5.3.4. 数据接收流程<a href="#534-数据接收流程" class="hash-link" aria-label="5.3.4. 数据接收流程的直接链接" title="5.3.4. 数据接收流程的直接链接">​</a></h4>
<p>有任何数据到达，MAC 将产生中断，则函数 aicmac_interrupt 被执行</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_interrupt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_napi_check</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;invoke aicmac_napi_poll_rx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_rx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;netif_msg_rx_status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_dma_desc_get_rx_status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;dma_sync_single_for_cpu</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;skb_copy_to_linear_data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;skb_put</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;page_pool_recycle_direct</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;skb_add_rx_frag</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;page_pool_release_page</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_1588_get_rx_hwtstamp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;skb_set_hash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;skb_record_rx_queue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;napi_gro_receive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_rx_refill</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_reg_enable_irq</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_set_operation_mode</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/mac-receive-170675737169829.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/mac-receive.jpg" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="535-dma初始化流程">5.3.5. DMA初始化流程<a href="#535-dma初始化流程" class="hash-link" aria-label="5.3.5. DMA初始化流程的直接链接" title="5.3.5. DMA初始化流程的直接链接">​</a></h4>
<p>DMA 模块将在设备 Open 的时候初始化 .. code-block:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">aicmac_dma_init_desc_rings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_init_rx_desc_rings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_clear_rx_descriptors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_dma_desc_init_rx_desc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_init_rx_buffers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_chain_init(RX,TX)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dmac_init_tx_desc_rings</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_desc_clear</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;netdev_tx_reset_queue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_clear_descriptors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_clear_rx_descriptors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_dma_desc_init_rx_desc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    |--&gt;aicmac_dma_clear_tx_descriptors</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        |--&gt;aicmac_dma_desc_init_tx_desc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">|--&gt;aicmac_dma_display_rings</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img loading="lazy" src="https://photos.100ask.net/artinchip-docs/d213-devkit/mac-dma-170675738921831.jpg" alt="../../../_https://photos.100ask.net/artinchip-docs/d213-devkit/mac-dma.jpg" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="6-常见问题">6. 常见问题<a href="#6-常见问题" class="hash-link" aria-label="6. 常见问题的直接链接" title="6. 常见问题的直接链接">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="61-mac-设备无法发现">6.1. MAC 设备无法发现<a href="#61-mac-设备无法发现" class="hash-link" aria-label="6.1. MAC 设备无法发现的直接链接" title="6.1. MAC 设备无法发现的直接链接">​</a></h3>
<p>如果使用 “ifconfig -a” 无法发现 MAC 设备，则主要是 MAC 驱动初始化异常，可以如下顺序排查:</p>
<ul>
<li>驱动模块是否编译和加载</li>
<li>dts 中 设备是否打开</li>
<li>初始化过程中是否有错误输出</li>
<li>GPIO 端口的功能配置是否正确</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="62-mac-无法发现-phy">6.2. MAC 无法发现 PHY<a href="#62-mac-无法发现-phy" class="hash-link" aria-label="6.2. MAC 无法发现 PHY的直接链接" title="6.2. MAC 无法发现 PHY的直接链接">​</a></h3>
<p>MAC 无法发现 PHY 一般是 MAC 和 PHY 的通信异常导致，PHY 的驱动一般是次要的，因为通用 PHY 驱动基本上可以驱动大部分</p>
<ul>
<li>PHY reset 是否配置正常</li>
<li>PHY 的地址是否配置正确，一般会有扫描机制，配置错误只会影响启动速度</li>
<li>MAC 和 PHY 的 MDC 时钟是否工作正常</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="63-网络不通">6.3. 网络不通<a href="#63-网络不通" class="hash-link" aria-label="6.3. 网络不通的直接链接" title="6.3. 网络不通的直接链接">​</a></h3>
<p>在 MAC 和 PHY 联通后而网络不通，譬如 ping 命令不通的原因很多，列一个检查项：</p>
<ul>
<li>MDATA 时钟是否配置正确，外部还是内部，必要时使用示波器检查一下波形和频率</li>
<li>时延是否配置正确，一定要和硬件原理图匹配</li>
<li>检查各寄存器是否有错误信息上报</li>
<li>当前网络环境是否有限制，如防火墙开启等</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/100askTeam/ArtInChip-Docs/tree/master/docs/D213-DevKit/part3/07-5_MAC-Useguide.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/D213-DevKit/part3/07-4_I2C-Useguide"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">I2C 开发指南</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/D213-DevKit/part3/07-6_PBus-Useguide"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">PBus 使用指南</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#1-模块介绍" class="table-of-contents__link toc-highlight">1. 模块介绍</a><ul><li><a href="#11-术语定义" class="table-of-contents__link toc-highlight">1.1. 术语定义</a></li><li><a href="#12-以太网简介" class="table-of-contents__link toc-highlight">1.2. 以太网简介</a></li><li><a href="#13-使用拓扑" class="table-of-contents__link toc-highlight">1.3. 使用拓扑</a></li><li><a href="#14-组件拓扑" class="table-of-contents__link toc-highlight">1.4. 组件拓扑</a></li><li><a href="#15-模块架构" class="table-of-contents__link toc-highlight">1.5. 模块架构</a></li><li><a href="#16-模块特性" class="table-of-contents__link toc-highlight">1.6. 模块特性</a></li></ul></li><li><a href="#2-使用指南" class="table-of-contents__link toc-highlight">2. 使用指南</a><ul><li><a href="#21-内核配置" class="table-of-contents__link toc-highlight">2.1. 内核配置</a></li><li><a href="#22-模块系统参数配置" class="table-of-contents__link toc-highlight">2.2. 模块 系统参数配置</a></li><li><a href="#23-功能参数配置" class="table-of-contents__link toc-highlight">2.3. 功能参数配置</a></li><li><a href="#24-时钟" class="table-of-contents__link toc-highlight">2.4. 时钟</a></li><li><a href="#25-mac地址" class="table-of-contents__link toc-highlight">2.5. MAC地址</a></li></ul></li><li><a href="#3-调试指南" class="table-of-contents__link toc-highlight">3. 调试指南</a><ul><li><a href="#31-调试开关" class="table-of-contents__link toc-highlight">3.1. 调试开关</a></li><li><a href="#32-功能验证" class="table-of-contents__link toc-highlight">3.2. 功能验证</a></li><li><a href="#33-寄存器信息" class="table-of-contents__link toc-highlight">3.3. 寄存器信息</a></li><li><a href="#34-驱动信息" class="table-of-contents__link toc-highlight">3.4. 驱动信息</a></li><li><a href="#35-设备信息" class="table-of-contents__link toc-highlight">3.5. 设备信息</a></li><li><a href="#36-辅助工具" class="table-of-contents__link toc-highlight">3.6. 辅助工具</a></li></ul></li><li><a href="#4-测试指南" class="table-of-contents__link toc-highlight">4. 测试指南</a><ul><li><a href="#41-准备工作" class="table-of-contents__link toc-highlight">4.1. 准备工作</a></li><li><a href="#42-组网拓扑" class="table-of-contents__link toc-highlight">4.2. 组网拓扑</a></li><li><a href="#43-功能测试" class="table-of-contents__link toc-highlight">4.3. 功能测试</a></li><li><a href="#44-速度测试" class="table-of-contents__link toc-highlight">4.4. 速度测试</a></li><li><a href="#45-兼容性测试" class="table-of-contents__link toc-highlight">4.5. 兼容性测试</a></li><li><a href="#46-性能测试" class="table-of-contents__link toc-highlight">4.6. 性能测试</a></li><li><a href="#47-稳定性测试" class="table-of-contents__link toc-highlight">4.7. 稳定性测试</a></li><li><a href="#48-高低温测试" class="table-of-contents__link toc-highlight">4.8. 高低温测试</a></li></ul></li><li><a href="#5-源码  说明" class="table-of-contents__link toc-highlight">5. 源码说明</a><ul><li><a href="#51-代码结构" class="table-of-contents__link toc-highlight">5.1. 代码结构</a></li><li><a href="#52-驱动架构" class="table-of-contents__link toc-highlight">5.2. 驱动架构</a></li><li><a href="#53-关键流程设计" class="table-of-contents__link toc-highlight">5.3. 关键流程设计</a></li></ul></li><li><a href="#6-常见问题" class="table-of-contents__link toc-highlight">6. 常见问题</a><ul><li><a href="#61-mac-设备无法发现" class="table-of-contents__link toc-highlight">6.1. MAC 设备无法发现</a></li><li><a href="#62-mac-无法发现-phy" class="table-of-contents__link toc-highlight">6.2. MAC 无法发现 PHY</a></li><li><a href="#63-网络不通" class="table-of-contents__link toc-highlight">6.3. 网络不通</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://dongshanpi.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">DongshanPI<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://canaan-docs.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Canaan-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://renesas-docs.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Renesas-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://rtos.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">RTOS<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://tina.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">TinaSDK-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://allwinner-docs.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Allwinner-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://aw-r128.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">R128-Docs<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://space.bilibili.com/275908810" target="_blank" rel="noopener noreferrer" class="footer__link-item">BiliBili<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://forums.100ask.net" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://video.100ask.net/" target="_blank" rel="noopener noreferrer" class="footer__link-item">VideoCenter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/dongshanpi" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://weidongshan.coding.net/public/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Coding<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/100askTeam" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gitee.com/weidongshan" target="_blank" rel="noopener noreferrer" class="footer__link-item">Gitee<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 100askTeam, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>